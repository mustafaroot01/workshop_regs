import{_ as h,r as n,o as j,c as o,a as e,b as i,F as I,m as M,d as x,e as _,T as N,z as E,h as a,n as P,t as r,y as q,s as u,i as U,j as w,J as G,v as B,l as H}from"./index-JQQaxJQX.js";import{e as A,f as Q,u as W,h as X,i as Y}from"./api-jdT4XKC_.js";const Z={class:"page-header"},tt={key:0,style:{"text-align":"center",padding:"4rem"}},et={key:1},st={key:0,class:"empty-state container card",style:{"margin-top":"2rem"}},lt={class:"forms-grid"},at={class:"card-top"},ot={key:0,class:"card-mgmt"},nt=["onClick","title"],it=["onClick"],rt={class:"card-main"},dt={class:"card-info"},ut={class:"card-title"},mt={style:{"font-size":"0.8rem",color:"var(--primary)","margin-top":"0.2rem","font-weight":"600"}},vt={key:0,class:"card-desc"},pt={class:"card-stat-box"},ct={class:"stat-num"},yt={class:"card-actions"},bt=["onClick","title"],gt={class:"link-val"},ft={class:"link-url"},kt={class:"link-copy-icon"},_t={class:"modal card",style:{"max-width":"380px","text-align":"center"}},xt={style:{color:"var(--text-3)","margin-top":"0.5rem","line-height":"1.6"}},wt={style:{display:"flex",gap:"0.8rem","margin-top":"1.8rem"}},Ct=["disabled"],Ft={key:0,class:"spinner"},$t={class:"modal card"},Dt={class:"form-group",style:{"margin-bottom":"1rem"}},Vt={key:0,class:"form-group",style:{"margin-bottom":"1rem"}},St=["value"],Tt={class:"form-group",style:{"margin-bottom":"1.5rem"}},zt={style:{display:"flex",gap:"0.8rem"}},It=["disabled"],Mt={key:0,class:"spinner"},Nt={__name:"FormsView",setup(Ut){const c=n(localStorage.getItem("admin_role")||"admin"),C=localStorage.getItem("admin_user"),F=C?JSON.parse(C):null,y=n(F?F.department_id:null),b=n([]),$=n([]),D=n(!0),m=n(!1),v=n(""),g=n(""),p=n(""),f=n(!1),d=n(null),k=n(!1);async function V(){const{data:l}=await A();b.value=l}async function L(){try{const[l,t]=await Promise.all([A(),Q()]);b.value=l.data,$.value=t.data}finally{D.value=!1}}j(L);async function S(){if(!(!v.value.trim()||!y.value&&!p.value)){f.value=!0;try{const l={title:v.value,description:g.value};y.value||(l.department_id=p.value),await Y(l),v.value="",g.value="",p.value="",m.value=!1,await V()}finally{f.value=!1}}}async function R(l){try{const t=!l.is_open;await W(l.id,{is_open:t}),l.is_open=t}catch{alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©.")}}function J(l){d.value=l}async function K(){if(d.value){k.value=!0;try{await X(d.value.id),d.value=null,await V()}catch{alert("Ø®Ø·Ø£: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø© Ù„ÙˆØ¬ÙˆØ¯ Ø³Ø¬Ù„Ø§Øª Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø§ Ø£Ùˆ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±.")}finally{k.value=!1}}}function O(l){navigator.clipboard.writeText(`${window.location.origin}/register/${l}`),copied.value=l,setTimeout(()=>{copied.value=null},2500)}return(l,t)=>{const T=E("router-link");return a(),o("div",null,[e("div",Z,[t[9]||(t[9]=e("div",null,[e("h2",{class:"gradient-text"},"Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø§Øª"),e("p",{style:{color:"var(--text-3)","margin-top":"0.3rem","font-size":"0.9rem"}},"Ø¥Ø¯Ø§Ø±Ø© Ø§Ø³ØªÙ…Ø§Ø±Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„")],-1)),c.value==="admin"?(a(),o("button",{key:0,class:"btn btn-primary",onClick:t[0]||(t[0]=s=>m.value=!0)},"+ Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©")):i("",!0)]),D.value?(a(),o("div",tt,[...t[10]||(t[10]=[e("div",{class:"spinner",style:{width:"40px",height:"40px","border-width":"3px"}},null,-1)])])):(a(),o("div",et,[b.value.length===0?(a(),o("div",st,[t[11]||(t[11]=e("div",{style:{"font-size":"3.5rem"}},"ðŸ“‹",-1)),t[12]||(t[12]=e("h3",{style:{"margin-top":"1rem"}},"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø³ØªÙ…Ø§Ø±Ø§Øª Ø¨Ø¹Ø¯",-1)),t[13]||(t[13]=e("p",{style:{color:"var(--text-3)","margin-top":"0.5rem"}},"Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø³ØªÙ…Ø§Ø±Ø© ÙˆØ±Ø´Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ø¢Ù†.",-1)),e("button",{class:"btn btn-primary",style:{"margin-top":"1.5rem"},onClick:t[1]||(t[1]=s=>m.value=!0)},"+ Ø£Ù†Ø´Ø¦ Ø§Ø³ØªÙ…Ø§Ø±ØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰")])):i("",!0),e("div",lt,[(a(!0),o(I,null,M(b.value,s=>(a(),o("div",{key:s.id,class:"form-card card"},[e("div",at,[e("span",{class:P(["badge",s.is_open?"badge-success":"badge-error"])},r(s.is_open?"Ù…ÙØªÙˆØ­Ø© Ø§Ù„Ø¢Ù†":"Ù…ØºÙ„Ù‚Ø©"),3),c.value==="admin"?(a(),o("div",ot,[e("button",{class:"mgmt-btn",onClick:z=>R(s),title:s.is_open?"Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„":"ÙØªØ­ Ø§Ù„ØªØ³Ø¬ÙŠÙ„"},r(s.is_open?"ðŸš«":"âœ…"),9,nt),e("button",{class:"mgmt-btn delete",onClick:z=>J(s),title:"Ø­Ø°Ù Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø©"}," ðŸ—‘ ",8,it)])):i("",!0)]),e("div",rt,[e("div",dt,[e("h3",ut,r(s.title),1),e("p",mt," ðŸ“Œ "+r(s.department?s.department.name:"Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…"),1),s.description?(a(),o("p",vt,r(s.description),1)):i("",!0)]),e("div",pt,[e("span",ct,r(s.students_count),1),t[14]||(t[14]=e("span",{class:"stat-label"},"Ù…Ø³Ø¬Ù‘Ù„",-1))])]),e("div",yt,[c.value==="admin"?(a(),q(T,{key:0,to:{name:"AdminFormDetail",params:{id:s.id}},class:"btn btn-secondary flex-1"},{default:_(()=>[...t[15]||(t[15]=[u(" Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø§Ø¨ ",-1)])]),_:1},8,["to"])):i("",!0),x(T,{to:{name:"AdminAttendance",params:{formId:s.id}},class:"btn btn-primary flex-1"},{default:_(()=>[...t[16]||(t[16]=[u(" Ù…ÙŽØ³Ø­ Ø§Ù„Ø­Ø¶ÙˆØ± ",-1)])]),_:1},8,["to"])]),c.value==="admin"?(a(),o("div",{key:0,class:"card-link",onClick:z=>O(s.id),title:l.copied===s.id?"ØªÙ… Ø§Ù„Ù†Ø³Ø®!":"Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·"},[t[17]||(t[17]=e("div",{class:"link-label"},"Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ³Ø¬ÙŠÙ„",-1)),e("div",gt,[e("span",ft,"/register/"+r(s.id),1),e("span",kt,r(l.copied===s.id?"âœ…":"ðŸ“‹"),1)])],8,bt)):i("",!0)]))),128))])])),x(N,{name:"fade"},{default:_(()=>[d.value?(a(),o("div",{key:0,class:"modal-backdrop",onClick:t[3]||(t[3]=U(s=>d.value=null,["self"]))},[e("div",_t,[t[23]||(t[23]=e("div",{style:{"font-size":"3rem","margin-bottom":"1rem"}},"âš ï¸",-1)),t[24]||(t[24]=e("h3",{style:{color:"var(--text-1)"}},"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù",-1)),e("p",xt,[t[18]||(t[18]=u(" Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ",-1)),e("b",null,'"'+r(d.value.title)+'"',1),t[19]||(t[19]=u("ØŸ",-1)),t[20]||(t[20]=e("br",null,null,-1)),t[21]||(t[21]=u(" Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø§ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. ",-1))]),e("div",wt,[e("button",{class:"btn btn-danger",style:{flex:"1"},onClick:K,disabled:k.value},[k.value?(a(),o("span",Ft)):i("",!0),t[22]||(t[22]=u(" Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù ",-1))],8,Ct),e("button",{class:"btn btn-ghost",style:{flex:"1"},onClick:t[2]||(t[2]=s=>d.value=null)},"Ø¥Ù„ØºØ§Ø¡")])])])):i("",!0)]),_:1}),x(N,{name:"fade"},{default:_(()=>[m.value?(a(),o("div",{key:0,class:"modal-backdrop",onClick:t[8]||(t[8]=U(s=>m.value=!1,["self"]))},[e("div",$t,[t[30]||(t[30]=e("h3",{style:{"margin-bottom":"1.5rem"}},"Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©",-1)),e("div",Dt,[t[25]||(t[25]=e("label",{class:"form-label"},"Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙˆØ±Ø´Ø© *",-1)),w(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>v.value=s),type:"text",class:"form-input",placeholder:"Ù…Ø«Ø§Ù„: ÙˆØ±Ø´Ø© Ø¹Ù…Ù„ ÙÙŠ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©",autoFocus:"",onKeyup:G(S,["enter"])},null,544),[[B,v.value]])]),y.value?i("",!0):(a(),o("div",Vt,[t[27]||(t[27]=e("label",{class:"form-label"},"Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù *",-1)),w(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>p.value=s),class:"form-input"},[t[26]||(t[26]=e("option",{value:"",disabled:""},"Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…...",-1)),(a(!0),o(I,null,M($.value,s=>(a(),o("option",{key:s.id,value:s.id},r(s.name),9,St))),128))],512),[[H,p.value]])])),e("div",Tt,[t[28]||(t[28]=e("label",{class:"form-label"},"ÙˆØµÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",-1)),w(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>g.value=s),class:"form-textarea",placeholder:"Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©..."},null,512),[[B,g.value]])]),e("div",zt,[e("button",{class:"btn btn-primary",style:{flex:"1"},onClick:S,disabled:!v.value.trim()||!y.value&&!p.value||f.value},[f.value?(a(),o("span",Mt)):i("",!0),t[29]||(t[29]=u(" Ø­ÙØ¸ ",-1))],8,It),e("button",{class:"btn btn-ghost",style:{flex:"1"},onClick:t[7]||(t[7]=s=>m.value=!1)},"Ø¥Ù„ØºØ§Ø¡")])])])):i("",!0)]),_:1})])}}},Lt=h(Nt,[["__scopeId","data-v-cfeedc39"]]);export{Lt as default};
