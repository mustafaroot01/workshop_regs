import{_ as G,o as H,c as a,a as t,t as u,i as f,v as x,A as F,b as g,F as z,l as I,k as j,d as J,e as O,T as W,r as i,q as X,g as l,n as Y,h as Z,s as T}from"./index-QrAWjh4S.js";import{j as $,k as E,n as L,o as ee,p as te,q as se,t as ae,v as le,w as ne}from"./api-Cwew99rJ.js";const oe={class:"settings-grid"},ie={class:"card settings-section"},re={class:"section-header"},de={class:"badge badge-primary"},ue={class:"add-row"},me=["disabled"],ve={key:0,class:"spinner"},pe={key:1},ce={key:0,class:"alert alert-error",style:{"margin-top":"0.5rem","font-size":"0.82rem"}},ye={class:"items-list"},ge={key:0,style:{"text-align":"center",padding:"1.5rem"}},_e={key:1,class:"empty-msg"},fe={class:"item-name"},be=["onClick"],he={class:"card settings-section"},we={class:"section-header"},ke={class:"badge badge-secondary"},xe={class:"add-row"},Ce=["value"],Ve=["disabled"],Ue=["disabled"],De={key:0,class:"spinner"},ze={key:1},Ie={key:0,class:"alert alert-error",style:{"margin-top":"0.5rem","font-size":"0.82rem"}},Se={class:"items-list"},Te={key:0,class:"empty-msg",style:{color:"var(--text-2)","font-weight":"500"}},$e={key:1,style:{"text-align":"center",padding:"1.5rem"}},Ee={key:2,class:"empty-msg"},Le={class:"item-name"},Me=["onClick"],Ne={class:"card settings-section",style:{"margin-top":"1.5rem"}},Be={class:"section-header"},Ke={class:"badge badge-success"},qe={class:"add-row"},Ae=["disabled"],Fe={key:0,class:"spinner"},je={key:1},Pe={key:0,class:"alert alert-error",style:{"margin-top":"0.5rem","font-size":"0.82rem"}},Qe={class:"items-list",style:{"margin-top":"1rem","max-height":"initial"}},Re={key:0,style:{width:"100%","text-align":"right","border-collapse":"collapse"}},Ge={style:{padding:"0.8rem 0.5rem","font-weight":"600"}},He={style:{padding:"0.8rem 0.5rem",color:"var(--text-2)","font-family":"monospace"}},Je={style:{padding:"0.8rem 0.5rem"}},Oe={style:{padding:"0.8rem 0.5rem"}},We=["onClick"],Xe={key:1,style:{"text-align":"center"}},Ye={class:"modal card",style:{"max-width":"380px","text-align":"center"}},Ze={style:{color:"var(--text-3)","margin-top":"0.5rem","line-height":"1.6"}},et={style:{display:"flex",gap:"0.8rem","margin-top":"1.8rem"}},tt=["disabled"],st={key:0,class:"spinner"},at={__name:"SettingsView",setup(lt){const _=i([]),k=i([]),b=i([]),h=i(""),w=i(""),p=i(""),o=i({name:"",email:"",password:"",role:"scanner"}),M=i(!0),N=i(!0),B=i(!0),C=i(""),V=i(""),U=i(""),m=i({dept:!1,interest:!1,user:!1}),r=i(null),D=i(!1),K=X(()=>p.value?k.value.filter(n=>n.department_id===p.value):[]);async function P(){const[n,e,s]=await Promise.all([$(),E(),L()]);_.value=n.data,M.value=!1,k.value=e.data,N.value=!1,b.value=s.data,B.value=!1}H(()=>{(localStorage.getItem("admin_role")||"admin")!=="admin"?window.location.href="/admin":P()});async function q(){var n,e,s,v,c,y;if(h.value.trim()){m.value.dept=!0,C.value="";try{await ee({name:h.value.trim()}),h.value="";const{data:d}=await $();_.value=d}catch(d){C.value=((v=(s=(e=(n=d.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:s.name)==null?void 0:v[0])||((y=(c=d.response)==null?void 0:c.data)==null?void 0:y.message)||"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©"}finally{m.value.dept=!1}}}async function A(){var n,e,s,v,c,y;if(!(!w.value.trim()||!p.value)){m.value.interest=!0,V.value="";try{await te({name:w.value.trim(),department_id:p.value}),w.value="";const{data:d}=await E();k.value=d}catch(d){V.value=((v=(s=(e=(n=d.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:s.name)==null?void 0:v[0])||((y=(c=d.response)==null?void 0:c.data)==null?void 0:y.message)||"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©"}finally{m.value.interest=!1}}}async function Q(){var n,e,s,v,c,y;if(!(!o.value.name||!o.value.email||!o.value.password)){m.value.user=!0,U.value="";try{await se(o.value),o.value={name:"",email:"",password:"",role:"scanner"};const{data:d}=await L();b.value=d}catch(d){U.value=((v=(s=(e=(n=d.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:s.email)==null?void 0:v[0])||((y=(c=d.response)==null?void 0:c.data)==null?void 0:y.message)||"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ Ø£Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…."}finally{m.value.user=!1}}}function S(n,e,s){r.value={type:n,id:e,name:s}}async function R(){var n,e;if(r.value){D.value=!0;try{if(r.value.type==="dept"){await ae(r.value.id);const{data:s}=await $();_.value=s}else if(r.value.type==="interest"){await le(r.value.id);const{data:s}=await E();k.value=s}else if(r.value.type==="user"){await ne(r.value.id);const{data:s}=await L();b.value=s}r.value=null}catch(s){alert(((e=(n=s.response)==null?void 0:n.data)==null?void 0:e.message)||"ØªØ¹Ø°Ø± Ø§Ù„Ø­Ø°Ù.")}finally{D.value=!1}}}return(n,e)=>(l(),a("div",null,[e[22]||(e[22]=t("div",{style:{"margin-bottom":"1.5rem"}},[t("h2",{class:"gradient-text"},"Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"),t("p",{style:{color:"var(--text-3)","font-size":"0.9rem","margin-top":"0.3rem"}},"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª")],-1)),t("div",oe,[t("div",ie,[t("div",re,[e[9]||(e[9]=t("h3",null,"ðŸ›ï¸ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…",-1)),t("span",de,u(_.value.length),1)]),t("div",ue,[f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>h.value=s),type:"text",class:"form-input",placeholder:"Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯...",onKeyup:F(q,["enter"])},null,544),[[x,h.value]]),t("button",{class:"btn btn-primary",onClick:q,disabled:!h.value.trim()||m.value.dept},[m.value.dept?(l(),a("span",ve)):(l(),a("span",pe,"+"))],8,me)]),C.value?(l(),a("div",ce,u(C.value),1)):g("",!0),t("div",ye,[M.value?(l(),a("div",ge,[...e[10]||(e[10]=[t("div",{class:"spinner"},null,-1)])])):_.value.length===0?(l(),a("div",_e,"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‚Ø³Ø§Ù… Ø¨Ø¹Ø¯")):g("",!0),(l(!0),a(z,null,I(_.value,s=>(l(),a("div",{key:s.id,class:"item-row"},[t("span",fe,u(s.name),1),t("button",{class:"btn btn-danger",style:{padding:"0.3rem 0.6rem","font-size":"0.8rem"},onClick:v=>S("dept",s.id,s.name)},"Ø­Ø°Ù",8,be)]))),128))])]),t("div",he,[t("div",we,[e[11]||(e[11]=t("h3",null,"ðŸ’¡ Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª",-1)),t("span",ke,u(k.value.length),1)]),t("div",xe,[f(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s),class:"form-input",style:{"max-width":"35%"}},[e[12]||(e[12]=t("option",{value:""},"Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…",-1)),(l(!0),a(z,null,I(_.value,s=>(l(),a("option",{key:s.id,value:s.id},u(s.name),9,Ce))),128))],512),[[j,p.value]]),f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>w.value=s),type:"text",class:"form-input",placeholder:"Ø§Ù‡ØªÙ…Ø§Ù… Ø¬Ø¯ÙŠØ¯...",onKeyup:F(A,["enter"]),disabled:!p.value},null,40,Ve),[[x,w.value]]),t("button",{class:"btn btn-primary",onClick:A,disabled:!w.value.trim()||!p.value||m.value.interest},[m.value.interest?(l(),a("span",De)):(l(),a("span",ze,"+"))],8,Ue)]),V.value?(l(),a("div",Ie,u(V.value),1)):g("",!0),t("div",Se,[p.value?N.value?(l(),a("div",$e,[...e[13]||(e[13]=[t("div",{class:"spinner"},null,-1)])])):K.value.length===0?(l(),a("div",Ee,"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨Ø¹Ø¯")):g("",!0):(l(),a("div",Te,"ðŸ‘† ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù‚Ø³Ù… Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ø¹Ø±Ø¶ Ø§Ù‡ØªÙ…Ø§Ù…Ø§ØªÙ‡")),(l(!0),a(z,null,I(K.value,s=>(l(),a("div",{key:s.id,class:"item-row"},[t("span",Le,u(s.name),1),t("button",{class:"btn btn-danger",style:{padding:"0.3rem 0.6rem","font-size":"0.8rem"},onClick:v=>S("interest",s.id,s.name)},"Ø­Ø°Ù",8,Me)]))),128))])])]),t("div",Ne,[t("div",Be,[e[14]||(e[14]=t("h3",null,"ðŸ‘¥ Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†)",-1)),t("span",Ke,u(b.value.length),1)]),t("div",qe,[f(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.name=s),type:"text",class:"form-input",placeholder:"Ø§Ù„Ø§Ø³Ù…"},null,512),[[x,o.value.name]]),f(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.email=s),type:"email",class:"form-input",placeholder:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"},null,512),[[x,o.value.email]]),f(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.password=s),type:"password",class:"form-input",placeholder:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"},null,512),[[x,o.value.password]]),f(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.role=s),class:"form-input",style:{"max-width":"150px"}},[...e[15]||(e[15]=[t("option",{value:"admin"},"Ù…Ø¯ÙŠØ± ÙƒØ§Ù…Ù„",-1),t("option",{value:"scanner"},"Ù…Ø§Ø³Ø­ ÙÙ‚Ø·",-1)])],512),[[j,o.value.role]]),t("button",{class:"btn btn-primary",onClick:Q,disabled:!o.value.name||!o.value.email||!o.value.password||m.value.user},[m.value.user?(l(),a("span",Fe)):(l(),a("span",je,"+ Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨"))],8,Ae)]),U.value?(l(),a("div",Pe,u(U.value),1)):g("",!0),t("div",Qe,[b.value.length>0?(l(),a("table",Re,[e[16]||(e[16]=t("tr",{style:{"border-bottom":"1px solid var(--border)"}},[t("th",{style:{padding:"0.5rem"}},"Ø§Ù„Ø§Ø³Ù…"),t("th",{style:{padding:"0.5rem"}},"Ø§Ù„Ø¨Ø±ÙŠØ¯"),t("th",{style:{padding:"0.5rem"}},"Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©"),t("th",{style:{padding:"0.5rem"}},"Ø¥Ø¬Ø±Ø§Ø¡")],-1)),(l(!0),a(z,null,I(b.value,s=>(l(),a("tr",{key:s.id,style:{"border-bottom":"1px solid rgba(255,255,255,0.05)"}},[t("td",Ge,u(s.name),1),t("td",He,u(s.email),1),t("td",Je,[t("span",{class:Y(["badge",s.role==="admin"?"badge-primary":"badge-secondary"]),style:{"font-size":"0.75rem"}},u(s.role==="admin"?"Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…":"ØªØ·Ø¨ÙŠÙ‚ Ù…Ø§Ø³Ø­ QRCode"),3)]),t("td",Oe,[t("button",{class:"btn btn-danger",style:{padding:"0.3rem 0.6rem","font-size":"0.8rem"},onClick:v=>S("user",s.id,s.name)},"Ø­Ø°Ù",8,We)])]))),128))])):B.value?(l(),a("div",Xe,[...e[17]||(e[17]=[t("div",{class:"spinner"},null,-1)])])):g("",!0)])]),J(W,{name:"fade"},{default:O(()=>[r.value?(l(),a("div",{key:0,class:"modal-backdrop",onClick:e[8]||(e[8]=Z(s=>r.value=null,["self"]))},[t("div",Ye,[e[20]||(e[20]=t("div",{style:{"font-size":"3rem","margin-bottom":"1rem"}},"âš ï¸",-1)),e[21]||(e[21]=t("h3",{style:{color:"var(--text-1)"}},"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù",-1)),t("p",Ze,[T(" Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù "+u(r.value.type==="dept"?"Ø§Ù„Ù‚Ø³Ù…":r.value.type==="user"?"Ø§Ù„Ø­Ø³Ø§Ø¨":"Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…")+" ",1),t("b",null,'"'+u(r.value.name)+'"',1),e[18]||(e[18]=T("ØŸ ",-1))]),t("div",et,[t("button",{class:"btn btn-danger",style:{flex:"1"},onClick:R,disabled:D.value},[D.value?(l(),a("span",st)):g("",!0),e[19]||(e[19]=T(" Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù ",-1))],8,tt),t("button",{class:"btn btn-ghost",style:{flex:"1"},onClick:e[7]||(e[7]=s=>r.value=null)},"Ø¥Ù„ØºØ§Ø¡")])])])):g("",!0)]),_:1})]))}},it=G(at,[["__scopeId","data-v-8857cd67"]]);export{it as default};
